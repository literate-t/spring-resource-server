<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>Index</title>
</head>
<body>
<div>OAuth2.0 Client</div>
<div sec:authorize="isAnonymous()"><a th:href="@{/oauth2/authorization/keycloak}">Login</a>
</div>
<div sec:authorize="isAuthenticated()">
  <form action="#">
    <p><input type="button" onclick="token()" value="access token"/>
  </form>
</div>
<script>
  const token = () => {
    fetch("/token")
    .then(response => {
      response.json().then((data) => {
        console.log("text 안에 데이터 = " + data.tokenValue);
        window.localStorage.setItem("access_token", data.tokenValue);
        location.href = "/home";
      })
    })
  }
</script>
</body>
</html>